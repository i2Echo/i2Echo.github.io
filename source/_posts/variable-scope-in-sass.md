---
title: sass中变量作用域的历史遗留问题
tags: [sass, scss]
date: 2017-04-16 15:58:23
categories: Sass
---

## 摘要
最近练手的一个vue项目，采用vue-cli脚手架快速生成项目框架，项目css部分采用sass预编译，但其间碰到一个有关sass变量作用域的，以前一直没注意到的问题；所以打算写下来，方便其他童鞋不踩到这个坑。
<!--more-->
## sass简介
### 什么是sass
SASS是一种CSS的开发工具，提供了许多便利的写法，大大节省了设计者的时间，使得CSS的开发，变得简单和可维护。
### sass有两种后缀名文件：
* 一种后缀名为sass，写选择器时不能使用大括号和分号
* 一种后缀名为scss，使用大括号和分号

``` sass
//后缀名为sass的语法，不能出现大括号和分号
$highlight-color: #abcdef
 
.selected
  border: 1px $highlight-color solid
   
//后缀名为scss的语法，跟css一样，需要大括号和分号
$highlight-color: #abcdef;
 
.selected{
  border:1px solid $highlight-color;
}
```
## sass变量
Sass的一个重要特性就是它为CSS引入了变量。你可以把反复使用的CSS属性值定义成变量，然后通过变量名来引用它们，而无需重复书写这一属性值。或者，对于仅使用过一次的属性值，你可以赋予其一个易懂的变量名，让人一眼就知道这个属性值的用途。
Sass使用“$”来标识变量，比如: $color, $width

### 全局变量和局部变量
#### 问题的由来
因为项目需要适配移动端，采用@media query媒体查询来处理，其中有一段css需要复用，所以采用sass的@mixin混合宏；但是在不同设备中是需要不同的宽高之类的变量值，因为用到的值多又不确定，所以不打算用传参的形式，就直接使用局部变量覆盖全局变量，然而我并没有得到预期的结果，一番排查之后，发现是局部变量不起作用；问题具体如下：
![sass](/images/upload/sass.png)
我预期的是div>a>p使用局部变量$color的值即blue，但实际上是red，那为什么不是预期的值呢，下面就说说sass全局变量和局部变量的作用域。

#### 变量的作用域
可以看到，我用的在线编译器的sass版本是3.4.21，我项目下用的sass编译器也是3.4以上的，但是在3.4版本以前，即比较3.3版本，在变量作用域这一块发生了改变，但是我却没有注意到。我们知道sass变量支持两种作用域，即全局变量和局部变量：
* 全局变量：默认情况下，所有定义在任何选择器之外的变量被认为是全局变量。这就意味着他们可以在样式表中任意地方被访问。
* 局部变量：定义在选择器之内的变量称之为局部变量

依照以前看的教程，变量作用域就一句话“sass没有全局变量”，因为全局变量在局部被重新声明的时候，局部变量会覆盖全局变量的值，即相当于重新声明了一个全局变量，后面再使用该变量是得到的值则是重新声明的值；但是在3.4版本的sass中已经不一样了，同名局部变量只会覆盖当前作用域下的变量值，其他作用域仍旧使用的是全局变量的值；回到上面的问题，为什么会出现预期不一样的结果，因为我的思路是基于3.3版本的sass的变量作用域，即后面再次调用mixin时将使用新的变量值；然而因为现在所使用的编译器是3.3版本以后的，所以就会出现这个与自己想法有出路的结果，那么除了说用传参解决，还有更好的办法吗，当然有。
#### global标志
新版本的sass中引入了一个global标志，可以让局部变量作用于全局范围，使用如下：
![sass](/images/upload/sass2.png)
这样得到的就是预期的结果了，感觉这个用法在使用媒体查询的时候特别有用，只要在局部重新定义一些变量值，就可以很方便的使用@mixin来复用样式块。

## 结论
本篇文章介绍了sass作用域的一个变动，以及巧用global标志来复用mixin的样式块。

